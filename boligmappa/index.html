<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bolig & Hage GitHub</title>
<style>
body { font-family: system-ui,sans-serif; margin:0; background:#f4f6f8; }
header{background:#1f6feb;color:white;padding:14px;text-align:center;font-size:20px;}
nav{display:flex;background:white;border-bottom:1px solid #ddd;}
nav button{flex:1;padding:12px;border:none;background:none;font-size:15px;}
nav button.active{background:#e8f0ff;font-weight:bold;}
section{display:none;padding:15px;}
section.active{display:block;}
.card{background:white;padding:12px;margin-bottom:10px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.06);}
input, select, textarea, button{width:100%;padding:10px;margin-top:6px;margin-bottom:8px;border-radius:8px;border:1px solid #ccc;font-size:15px;}
button.primary{background:#1f6feb;color:white;border:none;}
button.danger{background:#e5533d;color:white;border:none;}
.small{font-size:13px;color:#666;}
.status-ok{color:green;}
.status-due{color:red;font-weight:bold;}
</style>
</head>
<body>

<header>Bolig & Hage GitHub</header>
<nav>
<button onclick="tab('maintenance')" class="active">Vedlikehold</button>
<button onclick="tab('documents')">Boligmappe</button>
<button onclick="tab('plants')">Planter</button>
</nav>

<section id="maintenance" class="active">
<h3>Vedlikehold</h3>
<div id="maintenanceList"></div>
</section>

<section id="documents">
<h3>Boligmappe</h3>
<div id="documentsList"></div>
</section>

<section id="plants">
<h3>Planter</h3>
<div id="plantsList"></div>
</section>

<script>
function tab(id){
  document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  event.target.classList.add("active");
}

/* Hent JSON fra repo */
async function loadJSON(file){
  try{
    const res=await fetch(file);
    return await res.json();
  }catch(e){
    console.error(file,"ikke funnet:",e);
    return [];
  }
}

/* Vedlikehold */
async function renderMaintenance(){
  const data=await loadJSON('maintenance.json');
  const list=document.getElementById('maintenanceList');
  list.innerHTML='';
  data.forEach(m=>{
    list.innerHTML+=`<div class="card">
      <b>${m.title}</b> (${m.priority})<br>
      <span class="small">Dato: ${m.date || "Ingen"}</span>
      </div>`;
  });
}

/* Dokumenter */
async function renderDocuments(){
  // GitHub Pages har ikke API for mapper direkte, må liste filene manuelt
  const files=[
    {cat:"Forsikring", name:"forsikring1.pdf", url:"documents/forsikring/forsikring1.pdf"},
    {cat:"Kvitteringer", name:"elbillader.pdf", url:"documents/kvitteringer/elbillader.pdf"},
    {cat:"Manual", name:"varmepumpe.pdf", url:"documents/manualer/varmepumpe.pdf"}
  ];
  const list=document.getElementById('documentsList');
  list.innerHTML='';
  files.forEach(f=>{
    list.innerHTML+=`<div class="card">
      <b>${f.name}</b> (${f.cat})<br>
      <a href="${f.url}" target="_blank">Åpne fil</a>
    </div>`;
  });
}

/* Planter */
async function renderPlants(){
  const data=await loadJSON('plants.json');
  const list=document.getElementById('plantsList');
  list.innerHTML='';
  data.forEach(p=>{
    const nextWater=new Date(p.lastWater);
    nextWater.setDate(nextWater.getDate()+p.water);
    const due=nextWater<new Date();
    list.innerHTML+=`<div class="card">
      <b>${p.name}</b><br>
      <span class="${due?'status-due':'status-ok'}">
      Neste vanning: ${nextWater.toLocaleDateString()}
      </span>
    </div>`;
  });
}

/* Init */
renderMaintenance();
renderDocuments();
renderPlants();
</script>
</body>
</html>
